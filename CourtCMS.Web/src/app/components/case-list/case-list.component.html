<!-- SHARED NAVBAR -->
<app-navbar />

<!-- MAIN CONTENT AREA -->
<main class="main-content">
  <!-- DASHBOARD HEADER: Stats + Action Button -->
  <div class="dashboard-header">
    <div>
      <h2>Case Dashboard</h2>
      <p class="subtitle">Manage and track all active court cases</p>
    </div>
    <button class="btn-file-case" (click)="openCreateModal()">+ File New Case</button>
  </div>

  <!-- STATS BAR -->
  <!-- This section demonstrates data-driven UI thinking. -->
  <div class="stats-bar">
    <div class="stat-card">
      <span class="stat-number">{{ totalCases }}</span>
      <span class="stat-label">Total Cases</span>
    </div>
    <div class="stat-card stat-open">
      <span class="stat-number">{{ openCases }}</span>
      <span class="stat-label">Open</span>
    </div>
    <div class="stat-card stat-closed">
      <span class="stat-number">{{ closedCases }}</span>
      <span class="stat-label">Closed</span>
    </div>
  </div>

  <!-- CASE CARDS GRID -->
  <div class="card-grid">
    @for (courtCase of cases; track courtCase.id) {
      <div class="case-card">
        <div class="card-top-row">
          <h3>{{ courtCase.caseNumber }}</h3>
          <span
            class="status-badge"
            [class.closed]="courtCase.status === 'Closed'"
            [class.suspended]="courtCase.status === 'Suspended'"
          >
            {{ courtCase.status }}
          </span>
        </div>

        <p class="case-title">{{ courtCase.title }}</p>

        <div class="case-meta">
          <p>
            <span class="meta-label">Judge</span>
            {{ courtCase.assignedJudgeName }}
          </p>
          <p>
            <span class="meta-label">Filed</span>
            {{ courtCase.filingDate | date: 'mediumDate' }}
          </p>
        </div>

        <div class="card-actions">
          <button class="btn-action btn-view" [routerLink]="['/cases', courtCase.id]">
            View Details
          </button>
          <button class="btn-action btn-edit" (click)="openEditModal(courtCase)">Edit</button>

          @if (courtCase.status !== 'Closed') {
            <button class="btn-action btn-close-case" (click)="closeCase(courtCase)">Close</button>
          }

          <button class="btn-action btn-delete" (click)="deleteCase(courtCase)">Delete</button>
        </div>
      </div>
    } @empty {
      <div class="empty-state">
        <p class="empty-icon">ðŸ“‹</p>
        <p class="empty-title">No cases found</p>
        <p class="empty-subtitle">
          File a new case to get started, or check that the backend is running.
        </p>
      </div>
    }
  </div>
</main>

<!-- Case Form Modal -->
<app-case-form-modal
  [isOpen]="isModalOpen"
  [courtCase]="selectedCase"
  [judges]="judges"
  [isSaving]="isSaving"
  (closeModal)="closeModal()"
  (save)="onCaseSave($event)"
/>
