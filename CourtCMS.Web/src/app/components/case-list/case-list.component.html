<div class="container">
  <div class="page-header">
    <div>
      <h1>Orange County Superior Court</h1>
      <h2>Case Management Dashboard</h2>
    </div>
    <button class="btn-file-case" (click)="openCreateModal()">+ File New Case</button>
  </div>

  <div class="card-grid">
    @for (courtCase of cases; track courtCase.id) {
      <div class="case-card">
        <h3>{{ courtCase.caseNumber }}</h3>

        <p><strong>Title:</strong> {{ courtCase.title }}</p>
        <p><strong>Judge:</strong> {{ courtCase.assignedJudgeName }}</p>
        <p><strong>Filing Date:</strong> {{ courtCase.filingDate | date: 'mediumDate' }}</p>

        <div class="button-row">
          <span class="status-badge" [class.closed]="courtCase.status === 'Closed'">
            {{ courtCase.status }}
          </span>

          <button class="btn-edit" (click)="openEditModal(courtCase)">Edit</button>

          <button class="btn-view" [routerLink]="['/cases', courtCase.id]">View Details</button>

          @if (courtCase.status !== 'Closed') {
            <button class="btn-close" (click)="closeCase(courtCase)">Close Case</button>
          }

          <button class="btn-delete" (click)="deleteCase(courtCase)">Delete</button>
        </div>
      </div>
    } @empty {
      <p>No cases found. Is the backend running?</p>
    }
  </div>

  <!-- Case Form Modal -->
  <app-case-form-modal
    [isOpen]="isModalOpen"
    [courtCase]="selectedCase"
    [judges]="judges"
    (closeModal)="closeModal()"
    (save)="onCaseSave($event)"
  />
</div>
