@if (isOpen) {
  <div class="modal-backdrop" (click)="onClose()">
    <div class="modal-container" (click)="onModalClick($event)">
      <div class="modal-header">
        <h3>{{ isEditMode ? 'Edit Party' : 'Add New Party' }}</h3>
        <button class="btn-close-x" (click)="onClose()" aria-label="Close modal">&times;</button>
      </div>

      <div class="modal-body">
        <form [formGroup]="partyForm" (ngSubmit)="onSubmit()" id="partyForm">
          <fieldset [disabled]="isSaving">
            <!-- Name fields side by side -->
            <div class="form-row">
              <!-- FIRST NAME -->
              <div class="form-group">
                <label for="firstName">First Name</label>
                <input
                  type="text"
                  id="firstName"
                  formControlName="firstName"
                  placeholder="e.g. John"
                  [class.invalid]="showError('firstName')"
                />

                @if (showError('firstName')) {
                  <span class="error-message">
                    @if (partyForm.get('firstName')?.errors?.['required']) {
                      First name is required.
                    } @else if (partyForm.get('firstName')?.errors?.['minlength']) {
                      Must be at least 2 characters.
                    }
                  </span>
                }
              </div>

              <!-- LAST NAME -->
              <div class="form-group">
                <label for="lastName">Last Name</label>
                <input
                  type="text"
                  id="lastName"
                  formControlName="lastName"
                  placeholder="e.g. Doe"
                  [class.invalid]="showError('lastName')"
                />

                @if (showError('lastName')) {
                  <span class="error-message">
                    @if (partyForm.get('lastName')?.errors?.['required']) {
                      Last name is required.
                    } @else if (partyForm.get('lastName')?.errors?.['minlength']) {
                      Must be at least 2 characters.
                    }
                  </span>
                }
              </div>
            </div>

            <!-- EMAIL -->
            <div class="form-group">
              <label for="email">Email</label>
              <input
                type="email"
                id="email"
                formControlName="email"
                placeholder="e.g. john.doe@email.com"
                [class.invalid]="showError('email')"
              />
              @if (showError('email')) {
                <span class="error-message">
                  @if (partyForm.get('email')?.errors?.['required']) {
                    Email is required.
                  } @else if (partyForm.get('email')?.errors?.['pattern']) {
                    Enter a valid email address (e.g. john.doe&#64;email.com).
                  }
                </span>
              }
            </div>

            <!-- PHONE -->
            <div class="form-group">
              <label for="phone">Phone</label>
              <input
                type="tel"
                id="phone"
                formControlName="phone"
                placeholder="e.g. 714-555-0001"
                [class.invalid]="showError('phone')"
              />
              @if (showError('phone')) {
                <span class="error-message">
                  @if (partyForm.get('phone')?.errors?.['required']) {
                    Phone number is required.
                  } @else if (partyForm.get('phone')?.errors?.['minlength']) {
                    Must be at least 7 characters.
                  } @else if (partyForm.get('phone')?.errors?.['maxlength']) {
                    Cannot exceed 16 characters.
                  } @else if (partyForm.get('phone')?.errors?.['pattern']) {
                    Only digits, spaces, dashes, dots, and parentheses allowed.
                  }
                </span>
              }
            </div>
          </fieldset>
        </form>
      </div>

      <div class="modal-footer">
        <button class="btn-cancel" type="button" (click)="onClose()">Cancel</button>
        <button class="btn-save" type="submit" form="partyForm" [disabled]="isSubmitDisabled">
          {{ isSaving ? 'Saving...' : isEditMode ? 'Update Party' : 'Add Party' }}
        </button>
      </div>
    </div>
  </div>
}
